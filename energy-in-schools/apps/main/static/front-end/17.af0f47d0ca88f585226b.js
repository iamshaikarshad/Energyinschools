(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{U3gw:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),o=n.n(r),a=n("/MKj"),i=n("ANjH"),c=n("T2gY"),s=n.n(c),l=(n("17x9"),n("tRbT")),u=n("H2TA"),f=n("YXqb"),p=n("9OlM"),b=n("1wQb"),d=n("w793"),h=n("GkYJ"),y=n("LvDl"),g=n("ofer"),v=n("6u8J");function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k(this,n)}}function k(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D={root:{height:"100%",padding:"36px 72px",position:"relative"},messageBlockWrapper:{backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"50px"},messageBlock:{fontSize:32,fontFamily:n("TQzm").c.primary,fontWeight:900,color:"rgb(255, 255, 255)",maxWidth:"90%"}},x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(i,e);var t,n,r,a=j(i);function i(){var e;I(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return S(E(e=a.call.apply(a,[this].concat(n))),"state",{currentMessageIndex:0,slideVisible:!0}),S(E(e),"messageChangeInterval",null),S(E(e),"clearMessageChangeInterval",(function(){clearInterval(e.messageChangeInterval),e.messageChangeInterval=null})),S(E(e),"onSlideExited",(function(){var t=e.props.previewMessages,n=e.state.currentMessageIndex,r=Object(y.isEmpty)(t)?1:t.length;e.setState({currentMessageIndex:(n+1)%r,slideVisible:!0})})),S(E(e),"setMessageChangeInterval",(function(){var t=e.props,n=t.previewMessages,r=t.interval;Object(y.isNil)(e.messageChangeInterval)||e.clearMessageChangeInterval(),!Object(y.isEmpty)(n)&&n.length>1&&(e.messageChangeInterval=setInterval((function(){e.setState({slideVisible:!1})}),r))})),e}return t=i,(n=[{key:"componentDidMount",value:function(){this.setMessageChangeInterval()}},{key:"componentDidUpdate",value:function(e){var t=this.props.previewMessages;Object(y.isEqual)(e.previewMessages,t)||this.setMessageChangeInterval()}},{key:"componentWillUnmount",value:function(){this.clearMessageChangeInterval()}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.previewMessages,a=this.state,i=a.currentMessageIndex,c=a.slideVisible;return Object(y.isEmpty)(r)?null:o.a.createElement(l.a,{container:!0,className:n.root},o.a.createElement(l.a,{item:!0,container:!0,className:n.messageBlockWrapper,direction:"column",justify:"center",alignItems:"center",wrap:"nowrap"},o.a.createElement(v.a,{ref:function(t){e.slide=t},direction:"left",timeout:1e3,in:c,onExited:this.onSlideExited,exit:!1,mountOnEnter:!0,unmountOnExit:!0},o.a.createElement(g.a,{className:n.messageBlock,noWrap:!0},r[i]))))}}])&&O(t.prototype,n),r&&O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.a.Component);x.defaultProps={interval:1e4};var P=Object(u.a)(D)(x),M=n("mq8X"),T=n("Gj2X"),_=n("0nQm"),A=n("ZjC1"),R=n("yu+7"),B=n("OEMT"),G=n("9kxw"),Y=n("Jb/i"),W=n("32dx"),U=n("r4gL"),L=n("nQFv"),N=n("boEu"),H=n("K0eG"),J=n("sGJt"),V=n.n(J),F=n("pRtd"),Q=n.n(F),q=n("pEoX"),K=n.n(q),X=n("GBQ1"),z=n.n(X),Z=n("0y2O"),$=n.n(Z),ee=n("6Gp6"),te=[{refreshInterval:ee.c,action:function(e,t){t(Object(N.a)(ee.d.energyDashboardV2))}}],ne=new M.a(f.a,{messagesSlider:P},[],[ee.b.carbonIntensity],[{refreshInterval:18e5,action:function(e,t){t(Object(R.a)())}},{refreshInterval:864e5,action:function(e,t){t(Object(L.a)())}}],{backgroundImg:V.a,backgroundColor:"rgb(57, 193, 210)",name:"Carbon intensity"}),re=new M.a(p.a,{messagesSlider:P},["offPeakyYesterdayValue"],[ee.b.cashBack,ee.b.offPeakyLeague],[{refreshInterval:108e5,action:function(e,t){t(Object(_.a)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(A.b)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(A.a)())}}],{backgroundImg:Q.a,backgroundColor:"rgb(53, 110, 183)",name:"Off-peaky points"}),oe=new M.a(b.a,{},[],[ee.b.energyFacts],[{refreshInterval:864e5,action:function(e,t){t(Object(T.a)(e.schoolId))}}],{backgroundImg:$.a,backgroundColor:"rgb(48, 121, 135)",name:"Energy facts"}),ae=new M.a(d.a,{messagesSlider:P},["currentWeather","forecastWeather","electricityLiveData","electricityYesterdayData","electricityYesterdayCost"],[ee.b.electricityLiveConsumption,ee.b.electricityYesterdayConsumption,ee.b.weather,ee.b.electricityLeague,ee.b.electricityYesterdayCost,ee.b.electricityTariffs],[{refreshInterval:6e4,action:function(e,t){t(Object(Y.a)(H.k,e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(W.a)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(W.b)(e.schoolId))}},{refreshInterval:36e5,action:function(e,t){t(Object(B.a)(e.schoolId)),t(Object(B.c)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(G.a)())}},{refreshInterval:108e5,action:function(e,t){t(Object(U.a)())}}],{backgroundImg:K.a,backgroundColor:"rgb(229, 150, 114)",name:"Electricity usage"}),ie=new M.a(h.a,{messagesSlider:P},["currentWeather","forecastWeather","gasLiveData","gasYesterdayData","gasYesterdayCost"],[ee.b.gasLiveConsumption,ee.b.gasYesterdayConsumption,ee.b.weather,ee.b.gasLeague,ee.b.gasYesterdayCost,ee.b.gasTariffs],[{refreshInterval:6e4,action:function(e,t){t(Object(Y.b)(H.p,e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(W.c)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(W.d)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(G.b)())}},{refreshInterval:108e5,action:function(e,t){t(Object(U.b)())}}],{backgroundImg:z.a,backgroundColor:"rgb(77, 209, 241)",name:"Gas usage"}),ce=function(e){return e?[ne,ae,ie,re,oe]:[ne,ae,re,oe]},se=n("G/D/"),le=n("47xD"),ue=n("CeR/"),fe=n("dHhH");function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ie(e);if(t){var o=Ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return me(e)}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var we=n("BOF4"),je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ye(e,t)}(i,e);var t,n,r,a=ge(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Oe(me(t=a.call(this,e)),"getIfUseGas",(function(e){if(!e)return!0;try{return we(e).energy_types.includes(H.p)}catch(e){return console.log(e),!0}})),Oe(me(t),"keyPressHandler",(function(e){switch(e.keyCode){case 37:t.mainSlider.slickPrev();break;case 39:t.mainSlider.slickNext()}})),t.activeIntervalsIds=[],t}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match,r=t.dispatch,o=n.params.schoolId;Object(se.obtainDashboardToken)(o).then((function(t){e.callDashboardActions(o,t.access)}),(function(e){r(le.showAlert.bind("There is no school with that UID",Object(ue.a)(e))),console.log(e)}))}},{key:"shouldComponentUpdate",value:function(e){var t=this.props.energyDashboardData;return e.energyDashboardData.loadingEnds.status!==t.loadingEnds.status}},{key:"componentWillUnmount",value:function(){this.activeIntervalsIds.forEach((function(e){return clearInterval(e)})),this.activeIntervalsIds.length=0}},{key:"callDashboardActions",value:function(e,t){var n=this,r=this.props.dispatch,o=ce(this.getIfUseGas(t));te.forEach((function(t){var o=t.action,a=t.refreshInterval;o({schoolId:e},r),a&&n.activeIntervalsIds.push(setInterval((function(){o({schoolId:e},r)}),a))})),o.forEach((function(t){var o;t.invokeActions.forEach((function(t){t.action({schoolId:e},r)})),(o=n.activeIntervalsIds).push.apply(o,be(t.invokeActions.map((function(t){return setInterval((function(){t.action({schoolId:e},r)}),t.refreshInterval)}))))}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.energyDashboardData,a=this.getIfUseGas(fe.a.getAccessToken()),i=ce(a);return o.a.createElement(l.a,{container:!0,direction:"column",className:n.root,alignItems:"stretch",wrap:"nowrap",onKeyDown:this.keyPressHandler,tabIndex:"0"},o.a.createElement(l.a,{item:!0,xs:!0,container:!0,direction:"row",className:n.mainSlider},o.a.createElement(s.a,{ref:function(t){e.mainSlider=t},fade:!0,arrows:!1,autoplay:!0,autoplaySpeed:ee.a,infinite:!0,pauseOnHover:!1},i.map((function(e,t){return o.a.createElement(l.a,{className:n.slideGrid,key:"slide_".concat(t)}," ",e.renderMain(Object(ee.t)(r,e.slideKeys),r.loadingEnds,e.loadingFailedProps))})))))}}])&&he(t.prototype,n),r&&he(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.a.Component);t.default=Object(i.d)(Object(u.a)({root:{marginTop:0,marginBottom:0,paddingBottom:"0px",height:"100vh"},mainSlider:{position:"absolute",height:"100%",top:0},previewSlider:{position:"absolute",height:"20%",bottom:0},slideGrid:{height:"100%"}}),Object(a.c)((function(e){return{energyDashboardData:e.energyDashboard}}),null))(je)}}]);