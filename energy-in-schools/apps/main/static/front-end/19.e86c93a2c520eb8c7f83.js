(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{bM7g:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),o=n.n(r),a=n("/MKj"),i=n("ANjH"),c=n("T2gY"),s=n.n(c),l=(n("17x9"),n("tRbT")),u=n("H2TA"),f=n("DIgq"),p=n("qA3V"),b=n("ifHM"),y=n("DnAs"),d=n("WKyE"),h=n("LvDl"),g=n("ofer"),m=n("6u8J");function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k(this,n)}}function k(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D={root:{height:"100%",padding:"36px 72px",position:"relative"},messageBlockWrapper:{backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"50px"},messageBlock:{fontSize:32,fontFamily:n("TQzm").c.primary,fontWeight:900,color:"rgb(255, 255, 255)",maxWidth:"90%"}},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(i,e);var t,n,r,a=j(i);function i(){var e;I(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return S(E(e=a.call.apply(a,[this].concat(n))),"state",{currentMessageIndex:0,slideVisible:!0}),S(E(e),"messageChangeInterval",null),S(E(e),"clearMessageChangeInterval",(function(){clearInterval(e.messageChangeInterval),e.messageChangeInterval=null})),S(E(e),"onSlideExited",(function(){var t=e.props.previewMessages,n=e.state.currentMessageIndex,r=Object(h.isEmpty)(t)?1:t.length;e.setState({currentMessageIndex:(n+1)%r,slideVisible:!0})})),S(E(e),"setMessageChangeInterval",(function(){var t=e.props,n=t.previewMessages,r=t.interval;Object(h.isNil)(e.messageChangeInterval)||e.clearMessageChangeInterval(),!Object(h.isEmpty)(n)&&n.length>1&&(e.messageChangeInterval=setInterval((function(){e.setState({slideVisible:!1})}),r))})),e}return t=i,(n=[{key:"componentDidMount",value:function(){this.setMessageChangeInterval()}},{key:"componentDidUpdate",value:function(e){var t=this.props.previewMessages;Object(h.isEqual)(e.previewMessages,t)||this.setMessageChangeInterval()}},{key:"componentWillUnmount",value:function(){this.clearMessageChangeInterval()}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.previewMessages,a=this.state,i=a.currentMessageIndex,c=a.slideVisible;return Object(h.isEmpty)(r)?null:o.a.createElement(l.a,{container:!0,className:n.root},o.a.createElement(l.a,{item:!0,container:!0,className:n.messageBlockWrapper,direction:"column",justify:"center",alignItems:"center",wrap:"nowrap"},o.a.createElement(m.a,{ref:function(t){e.slide=t},direction:"left",timeout:1e3,in:c,onExited:this.onSlideExited,exit:!1,mountOnEnter:!0,unmountOnExit:!0},o.a.createElement(g.a,{className:n.messageBlock,noWrap:!0},r[i]))))}}])&&O(t.prototype,n),r&&O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.a.Component);P.defaultProps={interval:1e4};var x=Object(u.a)(D)(P),M=n("utqy"),T=n("yu+7"),A=n("OEMT"),_=n("Jb/i"),R=n("hDP9"),W=n("nddF"),B=n("r4gL"),H=n("nQFv"),N=n("/VNF"),L=n("+Cwg"),V=n("boEu"),G=n("K0eG"),U=n("sGJt"),q=n.n(U),F=n("pRtd"),J=n.n(F),K=n("pEoX"),z=n.n(K),Q=n("0y2O"),Y=n.n(Q),X=n("6Gp6"),$=[{refreshInterval:X.c,action:function(e,t){t(Object(V.a)(X.d.energyDashboardV3))}}],Z=new M.a(f.a,{},[],[X.b.schoolInformation],[{refreshInterval:108e5,action:function(e,t){t(Object(N.a)(e.schoolId))}}],{backgroundImg:J.a,backgroundColor:"rgb(53, 110, 183)",name:"Intro"}),ee=new M.a(p.a,{messagesSlider:x},[],[X.b.carbonIntensity],[{refreshInterval:18e5,action:function(e,t){t(Object(T.a)())}},{refreshInterval:864e5,action:function(e,t){t(Object(H.a)())}}],{backgroundImg:q.a,backgroundColor:"rgb(57, 193, 210)",name:"Carbon intensity"}),te=new M.a(b.a,{messagesSlider:x},["offPeakyLeagueData","offPeakyYesterdayValue"],[X.b.offPeakyLeague],[],{backgroundImg:J.a,backgroundColor:"rgb(53, 110, 183)",name:"Off-peaky points"}),ne=new M.a(y.a,{},[],[X.b.energyTips],[{refreshInterval:864e5,action:function(e,t){t(Object(L.a)())}}],{backgroundImg:Y.a,backgroundColor:"rgb(48, 121, 135)",name:"Energy tips"}),re=new M.a(d.a,{messagesSlider:x},["currentWeather","forecastWeather","electricityLiveData","electricityTodayData","electricityTodayCost","electricityLeagueData","lastWeekHistoricalCost","currentWeekHistoricalCost"],[X.b.electricityLiveConsumption,X.b.electricityTodayConsumption,X.b.weather,X.b.electricityTodayCost,X.b.electricityLeague,X.b.electricityTariffs,X.b.lastWeekHistoricalCost,X.b.currentWeekHistoricalCost],[{refreshInterval:6e4,action:function(e,t){t(Object(_.a)(G.k,e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(R.a)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(R.b)(e.schoolId))}},{refreshInterval:36e5,action:function(e,t){t(Object(A.a)(e.schoolId)),t(Object(A.c)(e.schoolId))}},{refreshInterval:108e5,action:function(e,t){t(Object(B.a)())}},{refreshInterval:864e5,action:function(e,t){t(Object(W.b)(e.schoolId))}},{refreshInterval:18e5,action:function(e,t){t(Object(W.a)(e.schoolId))}}],{backgroundImg:z.a,backgroundColor:"rgb(229, 150, 114)",name:"Electricity usage"}),oe=function(){return[Z,ee,re,te,ne]},ae=n("G/D/"),ie=n("47xD"),ce=n("CeR/");function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e){return function(e){if(Array.isArray(e))return ue(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=he(e);if(t){var o=he(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ye(this,n)}}function ye(e,t){if(t&&("object"===se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return de(e)}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}(i,e);var t,n,r,a=be(i);function i(e){var t,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=a.call(this,e),n=de(t),o=function(e){switch(e.keyCode){case 37:t.mainSlider.slickPrev();break;case 39:t.mainSlider.slickNext()}},(r="keyPressHandler")in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,t.activeIntervalsIds=[],t}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.match,r=t.dispatch,o=n.params.schoolId;Object(ae.obtainDashboardToken)(o).then((function(){e.callDashboardActions(o)}),(function(e){r(ie.showAlert.bind("There is no school with that UID",Object(ce.a)(e))),console.log(e)}))}},{key:"shouldComponentUpdate",value:function(e){var t=this.props.energyDashboardData;return e.energyDashboardData.loadingEnds.status!==t.loadingEnds.status}},{key:"componentWillUnmount",value:function(){this.activeIntervalsIds.forEach((function(e){return clearInterval(e)})),this.activeIntervalsIds.length=0}},{key:"callDashboardActions",value:function(e){var t=this,n=this.props.dispatch,r=oe();$.forEach((function(r){var o=r.action,a=r.refreshInterval;o({schoolId:e},n),a&&t.activeIntervalsIds.push(setInterval((function(){o({schoolId:e},n)}),a))})),r.forEach((function(r){var o;r.invokeActions.forEach((function(t){t.action({schoolId:e},n)})),(o=t.activeIntervalsIds).push.apply(o,le(r.invokeActions.map((function(t){return setInterval((function(){t.action({schoolId:e},n)}),t.refreshInterval)}))))}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.energyDashboardData,a=oe();return o.a.createElement(l.a,{container:!0,direction:"column",className:n.root,alignItems:"stretch",wrap:"nowrap",onKeyDown:this.keyPressHandler,tabIndex:"0"},o.a.createElement(l.a,{item:!0,xs:!0,container:!0,direction:"row",className:n.mainSlider},o.a.createElement(s.a,{ref:function(t){e.mainSlider=t},fade:!0,arrows:!1,autoplay:!0,autoplaySpeed:X.a,infinite:!0,pauseOnHover:!1},a.map((function(e,t){return o.a.createElement(l.a,{className:n.slideGrid,key:"slide_".concat(t)}," ",e.renderMain(Object(X.t)(r,e.slideKeys),r.loadingEnds,e.loadingFailedProps))})))))}}])&&fe(t.prototype,n),r&&fe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(o.a.Component);t.default=Object(i.d)(Object(u.a)({root:{marginTop:0,marginBottom:0,paddingBottom:"0px",height:"100vh"},mainSlider:{position:"absolute",height:"100%",top:0},previewSlider:{position:"absolute",height:"20%",bottom:0},slideGrid:{height:"100%"}}),Object(a.c)((function(e){return{energyDashboardData:e.energyDashboard}}),null))(ge)}}]);