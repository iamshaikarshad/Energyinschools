from datetime import date
from http import HTTPStatus
from unittest.mock import Mock, patch

from apps.hubs.base_test_case import HubBaseTestCase
from apps.weather.tests.base_test_case import WeatherBaseTestCase
from apps.microbit_weather.mocked_requests import  GET_CURRENT_WEATHER_FOR_CITY_F, \
     GET_CURRENT_WEATHER_FOR_POSTAL_CODE_F, GET_FORECAST_WEATHER_FOR_CITY_F, GET_FORECAST_WEATHER_FOR_POSTAL_CODE_F
from utilities.requests_mock import RequestMock


date_mock = Mock(wraps=date)
date_mock.today.return_value = date(2019, 1, 31)


class TestMicrobitValues(WeatherBaseTestCase, HubBaseTestCase):
    URL = '/api/v1/micro-bit/weather/'

    FAKE_WEATHER_REQUESTS_CACHE = {
        'http://api.openweathermap.org/data/2.5/weather?APPID=0868a2631b41f64f9b68f4928df3511c&q=London%2CGB&lang=en':
            '{"coord": {"lon": -0.13, "lat": 51.51}, "weather": [{"id": 803, "main": "Clouds", "description": "broken '
            'clouds", "icon": "04d"}], "base": "stations", "main": {"temp": 276.35, "pressure": 990, "humidity": 69, '
            '"temp_min": 275.15, "temp_max": 277.15}, "visibility": 10000, "wind": {"speed": 6.7, "deg": 110}, '
            '"clouds": {"all": 75}, "dt": 1548944400, "sys": {"type": 1, "id": 1414, "message": 0.0033, "country": '
            '"GB", "sunrise": 1548920396, "sunset": 1548953323}, "id": 2643743, "name": "London", "cod": 200} ',
        'http://api.openweathermap.org/data/2.5/weather?APPID=0868a2631b41f64f9b68f4928df3511c&zip=SW6%2CGB&lang=en':
            '{"coord": {"lon": -0.21, "lat": 51.47}, "weather": [{"id": 804, "main": "Clouds", "description": '
            '"overcast clouds", "icon": "04d"}], "base": "stations", "main": {"temp": 275.88, "pressure": 988, '
            '"humidity": 74, "temp_min": 274.15, "temp_max": 277.15}, "visibility": 10000, "wind": {"speed": 7.2, '
            '"deg": 100}, "clouds": {"all": 88}, "dt": 1548948000, "sys": {"type": 1, "id": 1417, "message": 0.0036, '
            '"country": "GB", "sunrise": 1548920403, "sunset": 1548953355}, "id": 580005559, "name": "Westminster", '
            '"cod": 200} ',
        'http://api.openweathermap.org/data/2.5/forecast?APPID=0868a2631b41f64f9b68f4928df3511c&q=London%2CGB&lang=en':
            '{"cod": "200", "message": 0.0038, "cnt": 40, "list": [{"dt": 1548957600, "main": {"temp": 273.85, '
            '"temp_min": 273.85, "temp_max": 274.145, "pressure": 992.28, "sea_level": 999.96, "grnd_level": 992.28, '
            '"humidity": 77, "temp_kf": -0.3}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", '
            '"icon": "10n"}], "clouds": {"all": 88}, "wind": {"speed": 5.71, "deg": 105.003}, "rain": {"3h": 0.0525}, '
            '"snow": {"3h": 0.374}, "sys": {"pod": "n"}, "dt_txt": "2019-01-31 18:00:00"}, {"dt": 1548968400, '
            '"main": {"temp": 273.51, "temp_min": 273.51, "temp_max": 273.737, "pressure": 990.85, "sea_level": '
            '998.44, "grnd_level": 990.85, "humidity": 84, "temp_kf": -0.22}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 5.92, '
            '"deg": 98.5017}, "rain": {"3h": 0.0025}, "snow": {"3h": 0.614}, "sys": {"pod": "n"}, "dt_txt": '
            '"2019-01-31 21:00:00"}, {"dt": 1548979200, "main": {"temp": 273.7, "temp_min": 273.7, "temp_max": '
            '273.852, "pressure": 990.48, "sea_level": 998.11, "grnd_level": 990.48, "humidity": 86, "temp_kf": '
            '-0.15}, "weather": [{"id": 600, "main": "Snow", "description": "light snow", "icon": "13n"}], '
            '"clouds": {"all": 80}, "wind": {"speed": 5.61, "deg": 85.5025}, "rain": {}, "snow": {"3h": 0.693}, '
            '"sys": {"pod": "n"}, "dt_txt": "2019-02-01 00:00:00"}, {"dt": 1548990000, "main": {"temp": 274.22, '
            '"temp_min": 274.22, "temp_max": 274.298, "pressure": 990.04, "sea_level": 997.73, "grnd_level": 990.04, '
            '"humidity": 88, "temp_kf": -0.07}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", '
            '"icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 5.91, "deg": 70.502}, "rain": {"3h": 0.005}, '
            '"snow": {"3h": 0.104}, "sys": {"pod": "n"}, "dt_txt": "2019-02-01 03:00:00"}, {"dt": 1549000800, '
            '"main": {"temp": 274.43, "temp_min": 274.43, "temp_max": 274.43, "pressure": 991.06, "sea_level": 998.8, '
            '"grnd_level": 991.06, "humidity": 92, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 88}, "wind": {"speed": 5.77, '
            '"deg": 55.0086}, "rain": {"3h": 0.205}, "snow": {"3h": 0.93125}, "sys": {"pod": "n"}, "dt_txt": '
            '"2019-02-01 06:00:00"}, {"dt": 1549011600, "main": {"temp": 274.711, "temp_min": 274.711, "temp_max": '
            '274.711, "pressure": 993.32, "sea_level": 1001.07, "grnd_level": 993.32, "humidity": 90, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10d"}], "clouds": {"all": '
            '80}, "wind": {"speed": 5.27, "deg": 46.0071}, "rain": {"3h": 0.22}, "snow": {"3h": 0.42125}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-01 09:00:00"}, {"dt": 1549022400, "main": {"temp": 276.236, '
            '"temp_min": 276.236, "temp_max": 276.236, "pressure": 994.96, "sea_level": 1002.55, "grnd_level": '
            '994.96, "humidity": 81, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light '
            'rain", "icon": "10d"}], "clouds": {"all": 68}, "wind": {"speed": 5.31, "deg": 45.0035}, "rain": {"3h": '
            '0.04}, "snow": {"3h": 0.0024999999999999}, "sys": {"pod": "d"}, "dt_txt": "2019-02-01 12:00:00"}, '
            '{"dt": 1549033200, "main": {"temp": 276.481, "temp_min": 276.481, "temp_max": 276.481, "pressure": 996, '
            '"sea_level": 1003.56, "grnd_level": 996, "humidity": 80, "temp_kf": 0}, "weather": [{"id": 803, '
            '"main": "Clouds", "description": "broken clouds", "icon": "04d"}], "clouds": {"all": 80}, '
            '"wind": {"speed": 5.36, "deg": 37.0043}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": '
            '"2019-02-01 15:00:00"}, {"dt": 1549044000, "main": {"temp": 275.253, "temp_min": 275.253, "temp_max": '
            '275.253, "pressure": 998.43, "sea_level": 1006.04, "grnd_level": 998.43, "humidity": 79, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], "clouds": {"all": '
            '100}, "wind": {"speed": 5.11, "deg": 31.5007}, "rain": {"3h": 0.035}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-01 18:00:00"}, {"dt": 1549054800, "main": {"temp": 274.861, "temp_min": 274.861, '
            '"temp_max": 274.861, "pressure": 999.96, "sea_level": 1007.66, "grnd_level": 999.96, "humidity": 81, '
            '"temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], '
            '"clouds": {"all": 88}, "wind": {"speed": 5.27, "deg": 16.5088}, "rain": {"3h": 0.075}, "snow": {"3h": '
            '0.0049999999999999}, "sys": {"pod": "n"}, "dt_txt": "2019-02-01 21:00:00"}, {"dt": 1549065600, '
            '"main": {"temp": 273.767, "temp_min": 273.767, "temp_max": 273.767, "pressure": 1002.17, "sea_level": '
            '1009.86, "grnd_level": 1002.17, "humidity": 85, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 64}, "wind": {"speed": 4.91, '
            '"deg": 9.50082}, "rain": {"3h": 0.015}, "snow": {"3h": 0.0074999999999998}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-02 00:00:00"}, {"dt": 1549076400, "main": {"temp": 273.582, "temp_min": 273.582, '
            '"temp_max": 273.582, "pressure": 1003.99, "sea_level": 1011.71, "grnd_level": 1003.99, "humidity": 87, '
            '"temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], '
            '"clouds": {"all": 64}, "wind": {"speed": 4.97, "deg": 2.5032}, "rain": {}, "snow": {"3h": '
            '0.0024999999999999}, "sys": {"pod": "n"}, "dt_txt": "2019-02-02 03:00:00"}, {"dt": 1549087200, '
            '"main": {"temp": 274.091, "temp_min": 274.091, "temp_max": 274.091, "pressure": 1006.02, "sea_level": '
            '1013.84, "grnd_level": 1006.02, "humidity": 84, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 76}, "wind": {"speed": 5.56, '
            '"deg": 355.003}, "rain": {"3h": 0.005}, "snow": {"3h": 0.0050000000000003}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-02 06:00:00"}, {"dt": 1549098000, "main": {"temp": 274.158, "temp_min": 274.158, '
            '"temp_max": 274.158, "pressure": 1009.34, "sea_level": 1017.05, "grnd_level": 1009.34, "humidity": 86, '
            '"temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": "scattered clouds", '
            '"icon": "03d"}], "clouds": {"all": 32}, "wind": {"speed": 5.67, "deg": 349.503}, "rain": {}, "snow": {}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-02 09:00:00"}, {"dt": 1549108800, "main": {"temp": 276.95, '
            '"temp_min": 276.95, "temp_max": 276.95, "pressure": 1011.38, "sea_level": 1019.08, "grnd_level": '
            '1011.38, "humidity": 77, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": '
            '"scattered clouds", "icon": "03d"}], "clouds": {"all": 36}, "wind": {"speed": 6.31, "deg": 352.005}, '
            '"rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-02 12:00:00"}, {"dt": 1549119600, '
            '"main": {"temp": 277.306, "temp_min": 277.306, "temp_max": 277.306, "pressure": 1013.38, "sea_level": '
            '1021.15, "grnd_level": 1013.38, "humidity": 75, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", '
            '"description": "scattered clouds", "icon": "03d"}], "clouds": {"all": 48}, "wind": {"speed": 6.41, '
            '"deg": 349.501}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-02 15:00:00"}, '
            '{"dt": 1549130400, "main": {"temp": 275.896, "temp_min": 275.896, "temp_max": 275.896, "pressure": '
            '1016.74, "sea_level": 1024.53, "grnd_level": 1016.74, "humidity": 74, "temp_kf": 0}, "weather": [{"id": '
            '802, "main": "Clouds", "description": "scattered clouds", "icon": "03n"}], "clouds": {"all": 44}, '
            '"wind": {"speed": 5.52, "deg": 343.505}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": '
            '"2019-02-02 18:00:00"}, {"dt": 1549141200, "main": {"temp": 273.998, "temp_min": 273.998, "temp_max": '
            '273.998, "pressure": 1019.61, "sea_level": 1027.37, "grnd_level": 1019.61, "humidity": 88, "temp_kf": '
            '0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], "clouds": {'
            '"all": 0}, "wind": {"speed": 5.16, "deg": 336.505}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-02 21:00:00"}, {"dt": 1549152000, "main": {"temp": 273.009, "temp_min": 273.009, '
            '"temp_max": 273.009, "pressure": 1021.89, "sea_level": 1029.77, "grnd_level": 1021.89, "humidity": 78, '
            '"temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], '
            '"clouds": {"all": 0}, "wind": {"speed": 4.67, "deg": 333.5}, "rain": {}, "snow": {}, "sys": {"pod": '
            '"n"}, "dt_txt": "2019-02-03 00:00:00"}, {"dt": 1549162800, "main": {"temp": 271.008, "temp_min": '
            '271.008, "temp_max": 271.008, "pressure": 1023.58, "sea_level": 1031.6, "grnd_level": 1023.58, '
            '"humidity": 72, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", '
            '"icon": "01n"}], "clouds": {"all": 0}, "wind": {"speed": 3.94, "deg": 318.006}, "rain": {}, "snow": {}, '
            '"sys": {"pod": "n"}, "dt_txt": "2019-02-03 03:00:00"}, {"dt": 1549173600, "main": {"temp": 271.552, '
            '"temp_min": 271.552, "temp_max": 271.552, "pressure": 1024.53, "sea_level": 1032.66, "grnd_level": '
            '1024.53, "humidity": 87, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light '
            'rain", "icon": "10n"}], "clouds": {"all": 0}, "wind": {"speed": 4.54, "deg": 297.003}, "rain": {"3h": '
            '0.005}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-03 06:00:00"}, {"dt": 1549184400, '
            '"main": {"temp": 272.204, "temp_min": 272.204, "temp_max": 272.204, "pressure": 1027.12, "sea_level": '
            '1035.05, "grnd_level": 1027.12, "humidity": 86, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", '
            '"description": "clear sky", "icon": "01d"}], "clouds": {"all": 0}, "wind": {"speed": 4.32, "deg": 315}, '
            '"rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-03 09:00:00"}, {"dt": 1549195200, '
            '"main": {"temp": 276.513, "temp_min": 276.513, "temp_max": 276.513, "pressure": 1028.59, "sea_level": '
            '1036.47, "grnd_level": 1028.59, "humidity": 71, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", '
            '"description": "clear sky", "icon": "01d"}], "clouds": {"all": 0}, "wind": {"speed": 3.46, '
            '"deg": 317.501}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-03 12:00:00"}, '
            '{"dt": 1549206000, "main": {"temp": 278.316, "temp_min": 278.316, "temp_max": 278.316, "pressure": '
            '1029.04, "sea_level": 1036.93, "grnd_level": 1029.04, "humidity": 65, "temp_kf": 0}, "weather": [{"id": '
            '800, "main": "Clear", "description": "clear sky", "icon": "01d"}], "clouds": {"all": 0}, '
            '"wind": {"speed": 3.17, "deg": 311.501}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": '
            '"2019-02-03 15:00:00"}, {"dt": 1549216800, "main": {"temp": 272.492, "temp_min": 272.492, "temp_max": '
            '272.492, "pressure": 1030.15, "sea_level": 1038.15, "grnd_level": 1030.15, "humidity": 88, "temp_kf": '
            '0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], "clouds": {'
            '"all": 0}, "wind": {"speed": 2.22, "deg": 258.002}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-03 18:00:00"}, {"dt": 1549227600, "main": {"temp": 267.52, "temp_min": 267.52, '
            '"temp_max": 267.52, "pressure": 1030.28, "sea_level": 1038.41, "grnd_level": 1030.28, "humidity": 82, '
            '"temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], '
            '"clouds": {"all": 0}, "wind": {"speed": 1.47, "deg": 205.001}, "rain": {}, "snow": {}, "sys": {"pod": '
            '"n"}, "dt_txt": "2019-02-03 21:00:00"}, {"dt": 1549238400, "main": {"temp": 269.257, "temp_min": '
            '269.257, "temp_max": 269.257, "pressure": 1030.03, "sea_level": 1038.14, "grnd_level": 1030.03, '
            '"humidity": 83, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": "scattered '
            'clouds", "icon": "03n"}], "clouds": {"all": 44}, "wind": {"speed": 3.02, "deg": 184.001}, "rain": {}, '
            '"snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 00:00:00"}, {"dt": 1549249200, "main": {"temp": '
            '272.569, "temp_min": 272.569, "temp_max": 272.569, "pressure": 1028.69, "sea_level": 1036.75, '
            '"grnd_level": 1028.69, "humidity": 95, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", '
            '"description": "scattered clouds", "icon": "03n"}], "clouds": {"all": 44}, "wind": {"speed": 3.57, '
            '"deg": 192.502}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 03:00:00"}, '
            '{"dt": 1549260000, "main": {"temp": 275.363, "temp_min": 275.363, "temp_max": 275.363, "pressure": '
            '1027.83, "sea_level": 1035.78, "grnd_level": 1027.83, "humidity": 89, "temp_kf": 0}, "weather": [{"id": '
            '803, "main": "Clouds", "description": "broken clouds", "icon": "04n"}], "clouds": {"all": 76}, '
            '"wind": {"speed": 3.97, "deg": 207}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 '
            '06:00:00"}, {"dt": 1549270800, "main": {"temp": 277.549, "temp_min": 277.549, "temp_max": 277.549, '
            '"pressure": 1027.31, "sea_level": 1035.15, "grnd_level": 1027.31, "humidity": 73, "temp_kf": 0}, '
            '"weather": [{"id": 803, "main": "Clouds", "description": "broken clouds", "icon": "04d"}], "clouds": {'
            '"all": 76}, "wind": {"speed": 4.91, "deg": 198.506}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, '
            '"dt_txt": "2019-02-04 09:00:00"}, {"dt": 1549281600, "main": {"temp": 280.348, "temp_min": 280.348, '
            '"temp_max": 280.348, "pressure": 1026.75, "sea_level": 1034.5, "grnd_level": 1026.75, "humidity": 65, '
            '"temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": "scattered clouds", '
            '"icon": "03d"}], "clouds": {"all": 36}, "wind": {"speed": 7.06, "deg": 207.001}, "rain": {}, "snow": {}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-04 12:00:00"}, {"dt": 1549292400, "main": {"temp": 279.985, '
            '"temp_min": 279.985, "temp_max": 279.985, "pressure": 1026.03, "sea_level": 1033.83, "grnd_level": '
            '1026.03, "humidity": 69, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light '
            'rain", "icon": "10d"}], "clouds": {"all": 64}, "wind": {"speed": 7.07, "deg": 209.507}, "rain": {"3h": '
            '0.04}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-04 15:00:00"}, {"dt": 1549303200, '
            '"main": {"temp": 278.746, "temp_min": 278.746, "temp_max": 278.746, "pressure": 1025.91, "sea_level": '
            '1033.72, "grnd_level": 1025.91, "humidity": 81, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 6.42, '
            '"deg": 205.004}, "rain": {"3h": 0.28}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 '
            '18:00:00"}, {"dt": 1549314000, "main": {"temp": 278.565, "temp_min": 278.565, "temp_max": 278.565, '
            '"pressure": 1026.14, "sea_level": 1033.88, "grnd_level": 1026.14, "humidity": 84, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], "clouds": {"all": '
            '92}, "wind": {"speed": 6.26, "deg": 206}, "rain": {"3h": 0.64}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-04 21:00:00"}, {"dt": 1549324800, "main": {"temp": 278.454, "temp_min": 278.454, '
            '"temp_max": 278.454, "pressure": 1026.85, "sea_level": 1034.64, "grnd_level": 1026.85, "humidity": 85, '
            '"temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], '
            '"clouds": {"all": 92}, "wind": {"speed": 5.58, "deg": 209.504}, "rain": {"3h": 0.51}, "snow": {}, '
            '"sys": {"pod": "n"}, "dt_txt": "2019-02-05 00:00:00"}, {"dt": 1549335600, "main": {"temp": 278.43, '
            '"temp_min": 278.43, "temp_max": 278.43, "pressure": 1027.1, "sea_level": 1035, "grnd_level": 1027.1, '
            '"humidity": 87, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", '
            '"icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 4.81, "deg": 215}, "rain": {"3h": 0.17}, '
            '"snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-05 03:00:00"}, {"dt": 1549346400, "main": {"temp": '
            '278.192, "temp_min": 278.192, "temp_max": 278.192, "pressure": 1027.68, "sea_level": 1035.46, '
            '"grnd_level": 1027.68, "humidity": 90, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 80}, "wind": {"speed": 3.81, '
            '"deg": 214.002}, "rain": {"3h": 0.16}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-05 '
            '06:00:00"}, {"dt": 1549357200, "main": {"temp": 278.389, "temp_min": 278.389, "temp_max": 278.389, '
            '"pressure": 1028.97, "sea_level": 1036.86, "grnd_level": 1028.97, "humidity": 89, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10d"}], "clouds": {"all": '
            '92}, "wind": {"speed": 3.62, "deg": 213.5}, "rain": {"3h": 0.13}, "snow": {}, "sys": {"pod": "d"}, '
            '"dt_txt": "2019-02-05 09:00:00"}, {"dt": 1549368000, "main": {"temp": 279.76, "temp_min": 279.76, '
            '"temp_max": 279.76, "pressure": 1030.07, "sea_level": 1037.78, "grnd_level": 1030.07, "humidity": 84, '
            '"temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10d"}], '
            '"clouds": {"all": 92}, "wind": {"speed": 3.37, "deg": 213.503}, "rain": {"3h": 0.14}, "snow": {}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-05 12:00:00"}, {"dt": 1549378800, "main": {"temp": 281.179, '
            '"temp_min": 281.179, "temp_max": 281.179, "pressure": 1029.47, "sea_level": 1037.29, "grnd_level": '
            '1029.47, "humidity": 76, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear '
            'sky", "icon": "01d"}], "clouds": {"all": 0}, "wind": {"speed": 2.92, "deg": 195.012}, "rain": {}, '
            '"snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-05 15:00:00"}], "city": {"id": 580005559, '
            '"name": "Westminster", "coord": {"lat": 51.4744, "lon": -0.2061}, "country": "GB"}} ',
        'http://api.openweathermap.org/data/2.5/forecast?APPID=0868a2631b41f64f9b68f4928df3511c&zip=SW6%2CGB&lang=en':
            '{"cod": "200", "message": 0.0038, "cnt": 40, "list": [{"dt": 1548957600, "main": {"temp": 273.85, '
            '"temp_min": 273.85, "temp_max": 274.145, "pressure": 992.28, "sea_level": 999.96, "grnd_level": 992.28, '
            '"humidity": 77, "temp_kf": -0.3}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", '
            '"icon": "10n"}], "clouds": {"all": 88}, "wind": {"speed": 5.71, "deg": 105.003}, "rain": {"3h": 0.0525}, '
            '"snow": {"3h": 0.374}, "sys": {"pod": "n"}, "dt_txt": "2019-01-31 18:00:00"}, {"dt": 1548968400, '
            '"main": {"temp": 273.51, "temp_min": 273.51, "temp_max": 273.737, "pressure": 990.85, "sea_level": '
            '998.44, "grnd_level": 990.85, "humidity": 84, "temp_kf": -0.22}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 5.92, '
            '"deg": 98.5017}, "rain": {"3h": 0.0025}, "snow": {"3h": 0.614}, "sys": {"pod": "n"}, "dt_txt": '
            '"2019-01-31 21:00:00"}, {"dt": 1548979200, "main": {"temp": 273.7, "temp_min": 273.7, "temp_max": '
            '273.852, "pressure": 990.48, "sea_level": 998.11, "grnd_level": 990.48, "humidity": 86, "temp_kf": '
            '-0.15}, "weather": [{"id": 600, "main": "Snow", "description": "light snow", "icon": "13n"}], '
            '"clouds": {"all": 80}, "wind": {"speed": 5.61, "deg": 85.5025}, "rain": {}, "snow": {"3h": 0.693}, '
            '"sys": {"pod": "n"}, "dt_txt": "2019-02-01 00:00:00"}, {"dt": 1548990000, "main": {"temp": 274.22, '
            '"temp_min": 274.22, "temp_max": 274.298, "pressure": 990.04, "sea_level": 997.73, "grnd_level": 990.04, '
            '"humidity": 88, "temp_kf": -0.07}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", '
            '"icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 5.91, "deg": 70.502}, "rain": {"3h": 0.005}, '
            '"snow": {"3h": 0.104}, "sys": {"pod": "n"}, "dt_txt": "2019-02-01 03:00:00"}, {"dt": 1549000800, '
            '"main": {"temp": 274.43, "temp_min": 274.43, "temp_max": 274.43, "pressure": 991.06, "sea_level": 998.8, '
            '"grnd_level": 991.06, "humidity": 92, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 88}, "wind": {"speed": 5.77, '
            '"deg": 55.0086}, "rain": {"3h": 0.205}, "snow": {"3h": 0.93125}, "sys": {"pod": "n"}, "dt_txt": '
            '"2019-02-01 06:00:00"}, {"dt": 1549011600, "main": {"temp": 274.711, "temp_min": 274.711, "temp_max": '
            '274.711, "pressure": 993.32, "sea_level": 1001.07, "grnd_level": 993.32, "humidity": 90, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10d"}], "clouds": {"all": '
            '80}, "wind": {"speed": 5.27, "deg": 46.0071}, "rain": {"3h": 0.22}, "snow": {"3h": 0.42125}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-01 09:00:00"}, {"dt": 1549022400, "main": {"temp": 276.236, '
            '"temp_min": 276.236, "temp_max": 276.236, "pressure": 994.96, "sea_level": 1002.55, "grnd_level": '
            '994.96, "humidity": 81, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light '
            'rain", "icon": "10d"}], "clouds": {"all": 68}, "wind": {"speed": 5.31, "deg": 45.0035}, "rain": {"3h": '
            '0.04}, "snow": {"3h": 0.0024999999999999}, "sys": {"pod": "d"}, "dt_txt": "2019-02-01 12:00:00"}, '
            '{"dt": 1549033200, "main": {"temp": 276.481, "temp_min": 276.481, "temp_max": 276.481, "pressure": 996, '
            '"sea_level": 1003.56, "grnd_level": 996, "humidity": 80, "temp_kf": 0}, "weather": [{"id": 803, '
            '"main": "Clouds", "description": "broken clouds", "icon": "04d"}], "clouds": {"all": 80}, '
            '"wind": {"speed": 5.36, "deg": 37.0043}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": '
            '"2019-02-01 15:00:00"}, {"dt": 1549044000, "main": {"temp": 275.253, "temp_min": 275.253, "temp_max": '
            '275.253, "pressure": 998.43, "sea_level": 1006.04, "grnd_level": 998.43, "humidity": 79, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], "clouds": {"all": '
            '100}, "wind": {"speed": 5.11, "deg": 31.5007}, "rain": {"3h": 0.035}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-01 18:00:00"}, {"dt": 1549054800, "main": {"temp": 274.861, "temp_min": 274.861, '
            '"temp_max": 274.861, "pressure": 999.96, "sea_level": 1007.66, "grnd_level": 999.96, "humidity": 81, '
            '"temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], '
            '"clouds": {"all": 88}, "wind": {"speed": 5.27, "deg": 16.5088}, "rain": {"3h": 0.075}, "snow": {"3h": '
            '0.0049999999999999}, "sys": {"pod": "n"}, "dt_txt": "2019-02-01 21:00:00"}, {"dt": 1549065600, '
            '"main": {"temp": 273.767, "temp_min": 273.767, "temp_max": 273.767, "pressure": 1002.17, "sea_level": '
            '1009.86, "grnd_level": 1002.17, "humidity": 85, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 64}, "wind": {"speed": 4.91, '
            '"deg": 9.50082}, "rain": {"3h": 0.015}, "snow": {"3h": 0.0074999999999998}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-02 00:00:00"}, {"dt": 1549076400, "main": {"temp": 273.582, "temp_min": 273.582, '
            '"temp_max": 273.582, "pressure": 1003.99, "sea_level": 1011.71, "grnd_level": 1003.99, "humidity": 87, '
            '"temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], '
            '"clouds": {"all": 64}, "wind": {"speed": 4.97, "deg": 2.5032}, "rain": {}, "snow": {"3h": '
            '0.0024999999999999}, "sys": {"pod": "n"}, "dt_txt": "2019-02-02 03:00:00"}, {"dt": 1549087200, '
            '"main": {"temp": 274.091, "temp_min": 274.091, "temp_max": 274.091, "pressure": 1006.02, "sea_level": '
            '1013.84, "grnd_level": 1006.02, "humidity": 84, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 76}, "wind": {"speed": 5.56, '
            '"deg": 355.003}, "rain": {"3h": 0.005}, "snow": {"3h": 0.0050000000000003}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-02 06:00:00"}, {"dt": 1549098000, "main": {"temp": 274.158, "temp_min": 274.158, '
            '"temp_max": 274.158, "pressure": 1009.34, "sea_level": 1017.05, "grnd_level": 1009.34, "humidity": 86, '
            '"temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": "scattered clouds", '
            '"icon": "03d"}], "clouds": {"all": 32}, "wind": {"speed": 5.67, "deg": 349.503}, "rain": {}, "snow": {}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-02 09:00:00"}, {"dt": 1549108800, "main": {"temp": 276.95, '
            '"temp_min": 276.95, "temp_max": 276.95, "pressure": 1011.38, "sea_level": 1019.08, "grnd_level": '
            '1011.38, "humidity": 77, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": '
            '"scattered clouds", "icon": "03d"}], "clouds": {"all": 36}, "wind": {"speed": 6.31, "deg": 352.005}, '
            '"rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-02 12:00:00"}, {"dt": 1549119600, '
            '"main": {"temp": 277.306, "temp_min": 277.306, "temp_max": 277.306, "pressure": 1013.38, "sea_level": '
            '1021.15, "grnd_level": 1013.38, "humidity": 75, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", '
            '"description": "scattered clouds", "icon": "03d"}], "clouds": {"all": 48}, "wind": {"speed": 6.41, '
            '"deg": 349.501}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-02 15:00:00"}, '
            '{"dt": 1549130400, "main": {"temp": 275.896, "temp_min": 275.896, "temp_max": 275.896, "pressure": '
            '1016.74, "sea_level": 1024.53, "grnd_level": 1016.74, "humidity": 74, "temp_kf": 0}, "weather": [{"id": '
            '802, "main": "Clouds", "description": "scattered clouds", "icon": "03n"}], "clouds": {"all": 44}, '
            '"wind": {"speed": 5.52, "deg": 343.505}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": '
            '"2019-02-02 18:00:00"}, {"dt": 1549141200, "main": {"temp": 273.998, "temp_min": 273.998, "temp_max": '
            '273.998, "pressure": 1019.61, "sea_level": 1027.37, "grnd_level": 1019.61, "humidity": 88, "temp_kf": '
            '0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], "clouds": {'
            '"all": 0}, "wind": {"speed": 5.16, "deg": 336.505}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-02 21:00:00"}, {"dt": 1549152000, "main": {"temp": 273.009, "temp_min": 273.009, '
            '"temp_max": 273.009, "pressure": 1021.89, "sea_level": 1029.77, "grnd_level": 1021.89, "humidity": 78, '
            '"temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], '
            '"clouds": {"all": 0}, "wind": {"speed": 4.67, "deg": 333.5}, "rain": {}, "snow": {}, "sys": {"pod": '
            '"n"}, "dt_txt": "2019-02-03 00:00:00"}, {"dt": 1549162800, "main": {"temp": 271.008, "temp_min": '
            '271.008, "temp_max": 271.008, "pressure": 1023.58, "sea_level": 1031.6, "grnd_level": 1023.58, '
            '"humidity": 72, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", '
            '"icon": "01n"}], "clouds": {"all": 0}, "wind": {"speed": 3.94, "deg": 318.006}, "rain": {}, "snow": {}, '
            '"sys": {"pod": "n"}, "dt_txt": "2019-02-03 03:00:00"}, {"dt": 1549173600, "main": {"temp": 271.552, '
            '"temp_min": 271.552, "temp_max": 271.552, "pressure": 1024.53, "sea_level": 1032.66, "grnd_level": '
            '1024.53, "humidity": 87, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light '
            'rain", "icon": "10n"}], "clouds": {"all": 0}, "wind": {"speed": 4.54, "deg": 297.003}, "rain": {"3h": '
            '0.005}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-03 06:00:00"}, {"dt": 1549184400, '
            '"main": {"temp": 272.204, "temp_min": 272.204, "temp_max": 272.204, "pressure": 1027.12, "sea_level": '
            '1035.05, "grnd_level": 1027.12, "humidity": 86, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", '
            '"description": "clear sky", "icon": "01d"}], "clouds": {"all": 0}, "wind": {"speed": 4.32, "deg": 315}, '
            '"rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-03 09:00:00"}, {"dt": 1549195200, '
            '"main": {"temp": 276.513, "temp_min": 276.513, "temp_max": 276.513, "pressure": 1028.59, "sea_level": '
            '1036.47, "grnd_level": 1028.59, "humidity": 71, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", '
            '"description": "clear sky", "icon": "01d"}], "clouds": {"all": 0}, "wind": {"speed": 3.46, '
            '"deg": 317.501}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-03 12:00:00"}, '
            '{"dt": 1549206000, "main": {"temp": 278.316, "temp_min": 278.316, "temp_max": 278.316, "pressure": '
            '1029.04, "sea_level": 1036.93, "grnd_level": 1029.04, "humidity": 65, "temp_kf": 0}, "weather": [{"id": '
            '800, "main": "Clear", "description": "clear sky", "icon": "01d"}], "clouds": {"all": 0}, '
            '"wind": {"speed": 3.17, "deg": 311.501}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": '
            '"2019-02-03 15:00:00"}, {"dt": 1549216800, "main": {"temp": 272.492, "temp_min": 272.492, "temp_max": '
            '272.492, "pressure": 1030.15, "sea_level": 1038.15, "grnd_level": 1030.15, "humidity": 88, "temp_kf": '
            '0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], "clouds": {'
            '"all": 0}, "wind": {"speed": 2.22, "deg": 258.002}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-03 18:00:00"}, {"dt": 1549227600, "main": {"temp": 267.52, "temp_min": 267.52, '
            '"temp_max": 267.52, "pressure": 1030.28, "sea_level": 1038.41, "grnd_level": 1030.28, "humidity": 82, '
            '"temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear sky", "icon": "01n"}], '
            '"clouds": {"all": 0}, "wind": {"speed": 1.47, "deg": 205.001}, "rain": {}, "snow": {}, "sys": {"pod": '
            '"n"}, "dt_txt": "2019-02-03 21:00:00"}, {"dt": 1549238400, "main": {"temp": 269.257, "temp_min": '
            '269.257, "temp_max": 269.257, "pressure": 1030.03, "sea_level": 1038.14, "grnd_level": 1030.03, '
            '"humidity": 83, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": "scattered '
            'clouds", "icon": "03n"}], "clouds": {"all": 44}, "wind": {"speed": 3.02, "deg": 184.001}, "rain": {}, '
            '"snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 00:00:00"}, {"dt": 1549249200, "main": {"temp": '
            '272.569, "temp_min": 272.569, "temp_max": 272.569, "pressure": 1028.69, "sea_level": 1036.75, '
            '"grnd_level": 1028.69, "humidity": 95, "temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", '
            '"description": "scattered clouds", "icon": "03n"}], "clouds": {"all": 44}, "wind": {"speed": 3.57, '
            '"deg": 192.502}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 03:00:00"}, '
            '{"dt": 1549260000, "main": {"temp": 275.363, "temp_min": 275.363, "temp_max": 275.363, "pressure": '
            '1027.83, "sea_level": 1035.78, "grnd_level": 1027.83, "humidity": 89, "temp_kf": 0}, "weather": [{"id": '
            '803, "main": "Clouds", "description": "broken clouds", "icon": "04n"}], "clouds": {"all": 76}, '
            '"wind": {"speed": 3.97, "deg": 207}, "rain": {}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 '
            '06:00:00"}, {"dt": 1549270800, "main": {"temp": 277.549, "temp_min": 277.549, "temp_max": 277.549, '
            '"pressure": 1027.31, "sea_level": 1035.15, "grnd_level": 1027.31, "humidity": 73, "temp_kf": 0}, '
            '"weather": [{"id": 803, "main": "Clouds", "description": "broken clouds", "icon": "04d"}], "clouds": {'
            '"all": 76}, "wind": {"speed": 4.91, "deg": 198.506}, "rain": {}, "snow": {}, "sys": {"pod": "d"}, '
            '"dt_txt": "2019-02-04 09:00:00"}, {"dt": 1549281600, "main": {"temp": 280.348, "temp_min": 280.348, '
            '"temp_max": 280.348, "pressure": 1026.75, "sea_level": 1034.5, "grnd_level": 1026.75, "humidity": 65, '
            '"temp_kf": 0}, "weather": [{"id": 802, "main": "Clouds", "description": "scattered clouds", '
            '"icon": "03d"}], "clouds": {"all": 36}, "wind": {"speed": 7.06, "deg": 207.001}, "rain": {}, "snow": {}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-04 12:00:00"}, {"dt": 1549292400, "main": {"temp": 279.985, '
            '"temp_min": 279.985, "temp_max": 279.985, "pressure": 1026.03, "sea_level": 1033.83, "grnd_level": '
            '1026.03, "humidity": 69, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light '
            'rain", "icon": "10d"}], "clouds": {"all": 64}, "wind": {"speed": 7.07, "deg": 209.507}, "rain": {"3h": '
            '0.04}, "snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-04 15:00:00"}, {"dt": 1549303200, '
            '"main": {"temp": 278.746, "temp_min": 278.746, "temp_max": 278.746, "pressure": 1025.91, "sea_level": '
            '1033.72, "grnd_level": 1025.91, "humidity": 81, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 6.42, '
            '"deg": 205.004}, "rain": {"3h": 0.28}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-04 '
            '18:00:00"}, {"dt": 1549314000, "main": {"temp": 278.565, "temp_min": 278.565, "temp_max": 278.565, '
            '"pressure": 1026.14, "sea_level": 1033.88, "grnd_level": 1026.14, "humidity": 84, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], "clouds": {"all": '
            '92}, "wind": {"speed": 6.26, "deg": 206}, "rain": {"3h": 0.64}, "snow": {}, "sys": {"pod": "n"}, '
            '"dt_txt": "2019-02-04 21:00:00"}, {"dt": 1549324800, "main": {"temp": 278.454, "temp_min": 278.454, '
            '"temp_max": 278.454, "pressure": 1026.85, "sea_level": 1034.64, "grnd_level": 1026.85, "humidity": 85, '
            '"temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10n"}], '
            '"clouds": {"all": 92}, "wind": {"speed": 5.58, "deg": 209.504}, "rain": {"3h": 0.51}, "snow": {}, '
            '"sys": {"pod": "n"}, "dt_txt": "2019-02-05 00:00:00"}, {"dt": 1549335600, "main": {"temp": 278.43, '
            '"temp_min": 278.43, "temp_max": 278.43, "pressure": 1027.1, "sea_level": 1035, "grnd_level": 1027.1, '
            '"humidity": 87, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", '
            '"icon": "10n"}], "clouds": {"all": 92}, "wind": {"speed": 4.81, "deg": 215}, "rain": {"3h": 0.17}, '
            '"snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-05 03:00:00"}, {"dt": 1549346400, "main": {"temp": '
            '278.192, "temp_min": 278.192, "temp_max": 278.192, "pressure": 1027.68, "sea_level": 1035.46, '
            '"grnd_level": 1027.68, "humidity": 90, "temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", '
            '"description": "light rain", "icon": "10n"}], "clouds": {"all": 80}, "wind": {"speed": 3.81, '
            '"deg": 214.002}, "rain": {"3h": 0.16}, "snow": {}, "sys": {"pod": "n"}, "dt_txt": "2019-02-05 '
            '06:00:00"}, {"dt": 1549357200, "main": {"temp": 278.389, "temp_min": 278.389, "temp_max": 278.389, '
            '"pressure": 1028.97, "sea_level": 1036.86, "grnd_level": 1028.97, "humidity": 89, "temp_kf": 0}, '
            '"weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10d"}], "clouds": {"all": '
            '92}, "wind": {"speed": 3.62, "deg": 213.5}, "rain": {"3h": 0.13}, "snow": {}, "sys": {"pod": "d"}, '
            '"dt_txt": "2019-02-05 09:00:00"}, {"dt": 1549368000, "main": {"temp": 279.76, "temp_min": 279.76, '
            '"temp_max": 279.76, "pressure": 1030.07, "sea_level": 1037.78, "grnd_level": 1030.07, "humidity": 84, '
            '"temp_kf": 0}, "weather": [{"id": 500, "main": "Rain", "description": "light rain", "icon": "10d"}], '
            '"clouds": {"all": 92}, "wind": {"speed": 3.37, "deg": 213.503}, "rain": {"3h": 0.14}, "snow": {}, '
            '"sys": {"pod": "d"}, "dt_txt": "2019-02-05 12:00:00"}, {"dt": 1549378800, "main": {"temp": 281.179, '
            '"temp_min": 281.179, "temp_max": 281.179, "pressure": 1029.47, "sea_level": 1037.29, "grnd_level": '
            '1029.47, "humidity": 76, "temp_kf": 0}, "weather": [{"id": 800, "main": "Clear", "description": "clear '
            'sky", "icon": "01d"}], "clouds": {"all": 0}, "wind": {"speed": 2.92, "deg": 195.012}, "rain": {}, '
            '"snow": {}, "sys": {"pod": "d"}, "dt_txt": "2019-02-05 15:00:00"}], "city": {"id": 580005559, '
            '"name": "Westminster", "coord": {"lat": 51.4744, "lon": -0.2061}, "country": "GB"}} '
    }

    @patch('apps.microbit_weather.views.date', new=date_mock)
    @RequestMock.assert_requests([
        GET_CURRENT_WEATHER_FOR_CITY_F,
        GET_CURRENT_WEATHER_FOR_POSTAL_CODE_F,
    ])
    def test_current_weather(self):
        path = 'current'

        with self.subTest('get current weather for wrong city'):
            params = dict(city='Wrong')
            response = self.client.get(self.get_url(path, query_param=params), **self.get_hub_headers())
            self.assertResponse(response, expected_status=HTTPStatus.BAD_REQUEST)
        with self.subTest('get current weather for wrong postal code'):
            params = dict(postal_code='Wrong')
            response = self.client.get(self.get_url(path, query_param=params), **self.get_hub_headers())
            self.assertResponse(response, expected_status=HTTPStatus.BAD_REQUEST)

    @patch('apps.microbit_weather.views.date', new=date_mock)
    @RequestMock.assert_requests([
        GET_FORECAST_WEATHER_FOR_CITY_F,
        GET_FORECAST_WEATHER_FOR_POSTAL_CODE_F,

    ])
    def test_weather_forecast(self):
        path = 'forecast/tomorrow'
        with self.subTest('get weather forecast for wrong city'):
            params = dict(city='Wrong')
            response = self.client.get(self.get_url(path, query_param=params), **self.get_hub_headers())
            self.assertResponse(response, expected_status=HTTPStatus.BAD_REQUEST)
        with self.subTest('get weather forecast for wrong postal code'):
            params = dict(postal_code='Wrong')
            response = self.client.get(self.get_url(path, query_param=params), **self.get_hub_headers())
            self.assertResponse(response, expected_status=HTTPStatus.BAD_REQUEST)

    @patch('apps.microbit_weather.views.date', new=date_mock)
    def test_weather(self):
        for path in ('current', 'forecast/tomorrow'):
            for params, expected_status in (
                    (dict(), HTTPStatus.BAD_REQUEST),
                    (dict(city='London'), HTTPStatus.OK),
                    (dict(postal_code='SW6'), HTTPStatus.OK),
                    (dict(city='London', postal_code='EC2A 2EH'), HTTPStatus.BAD_REQUEST),
            ):
                with self.subTest(f'{path} - {params}'):
                    response = self.client.get(self.get_url(path, query_param=params), **self.get_hub_headers())
                    self.assertResponse(response, expected_status=expected_status)
